<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار الشخصية: أي حيوان أنت؟</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');

        :root {
            --primary-color: #4fd1c5; /* تركواز */
            --background-color: #1a202c; /* كحلي غامق */
            --card-background: #2d3748; /* رمادي غامق */
            --text-color: #e2e8f0; /* أبيض مائل للرمادي */
            --text-muted: #a0aec0; /* رمادي فاتح */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column; /* للسماح بوضع الإعلانات بالأسفل */
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background-color: var(--card-background);
            padding: 30px 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 550px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: white;
            margin-bottom: 15px;
            font-size: 2.2em;
        }

        p {
            font-size: 1.1em;
            color: var(--text-muted);
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .btn {
            background: linear-gradient(45deg, var(--primary-color), #38b2ac);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 50px;
            font-size: 1.2em;
            font-family: 'Tajawal', sans-serif;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(79, 209, 197, 0.2);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(79, 209, 197, 0.3);
        }

        .btn i {
            margin-right: 10px;
        }

        /* شاشة الأسئلة */
        #quiz-screen {
            text-align: right;
        }
        
        #question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        #question-number {
            background-color: rgba(79, 209, 197, 0.1);
            color: var(--primary-color);
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 700;
        }

        #question-text {
            font-size: 1.4em;
            color: white;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .option-btn {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            font-family: 'Tajawal', sans-serif;
            border: 2px solid #4a5568;
            background-color: transparent;
            color: var(--text-muted);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: right;
        }

        .option-btn:hover {
            border-color: var(--primary-color);
            background-color: rgba(79, 209, 197, 0.1);
            color: white;
        }

        .progress-bar {
            width: 100%;
            background-color: #4a5568;
            border-radius: 5px;
            height: 8px;
            margin-top: 30px;
            overflow: hidden;
        }

        .progress {
            width: 0;
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 5px;
            transition: width 0.5s ease-in-out;
        }

        /* شاشة النتيجة */
        #result-image {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            object-fit: cover;
            border: 6px solid var(--primary-color);
            margin-bottom: 20px;
            box-shadow: 0 0 25px rgba(79, 209, 197, 0.3);
        }
        
        #result-animal {
            color: var(--primary-color);
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(79, 209, 197, 0.5);
        }

        .result-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        #share-btn {
             background: linear-gradient(45deg, #27ae60, #2ecc71);
        }
        
        .ad-placeholder {
            width: 100%;
            max-width: 728px; /* حجم بانر شائع */
            min-height: 90px;
            background-color: var(--card-background);
            border: 1px dashed #4a5568;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 40px;
            border-radius: 10px;
            color: var(--text-muted);
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <div class="container">
        <div id="intro-screen">
            <h1>اكتشف الحيوان اللي يشبهك</h1>
            <p>أجب على 10 أسئلة دقيقة لاستكشاف أعماق شخصيتك والتعرف على الحيوان الذي يمثلك.</p>
            <button class="btn" id="start-btn"><i class="fas fa-paw"></i> بدء الاختبار</button>
        </div>

        <div id="quiz-screen" class="hidden">
            <div id="question-container">
                <div id="question-header">
                     <h2 id="question-text"></h2>
                     <span id="question-number"></span>
                </div>
                <div class="options-grid" id="options-container"></div>
            </div>
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
        </div>

        <div id="result-screen" class="hidden">
            <h1>شخصيتك تشبه...</h1>
            <img id="result-image" src="" alt="صورة الحيوان">
            <h2 id="result-animal"></h2>
            <p id="result-description"></p>
            <div class="result-actions">
                 <button class="btn" id="restart-btn"><i class="fas fa-redo"></i> إعادة الاختبار</button>
                 <button class="btn" id="share-btn"><i class="fab fa-whatsapp"></i> مشاركة النتيجة</button>
            </div>
        </div>
    </div>
    
    <div class="ad-placeholder">
        <span>مساحة إعلانية لـ Google AdSense</span>
    </div>

    <script>
        // --- عناصر التحكم ---
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const shareBtn = document.getElementById('share-btn');
        const introScreen = document.getElementById('intro-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        const questionText = document.getElementById('question-text');
        const questionNumber = document.getElementById('question-number');
        const optionsContainer = document.getElementById('options-container');
        const progressBar = document.getElementById('progress');
        const resultImage = document.getElementById('result-image');
        const resultAnimal = document.getElementById('result-animal');
        const resultDescription = document.getElementById('result-description');

        // --- بيانات الاختبار ---
        const questions = [
            { question: "كيف تفضل قضاء ليلة الجمعة؟", options: [{ text: "في حفل كبير مع الكثير من الأصدقاء", value: { lion: 1, dolphin: 1 } }, { text: "مع مجموعة صغيرة من الأصدقاء المقربين", value: { wolf: 1 } }, { text: "في المنزل بهدوء مع كتاب أو فيلم", value: { owl: 1 } }, { text: "أجرب شيئًا جديدًا ومغامرة عفوية", value: { dolphin: 1, fox: 1 } } ] },
            { question: "عندما تواجه مشكلة صعبة، أول ما تفعله هو:", options: [ { text: "أبحث عن حلول مبتكرة وغير متوقعة", value: { dolphin: 1, fox: 1 } }, { text: "أحلل الموقف من جميع الزوايا بهدوء", value: { owl: 1 } }, { text: "أجمع فريقي أو أصدقائي للمساعدة", value: { wolf: 1, lion: 1 } }, { text: "أتولى زمام المبادرة وأقود الحل بنفسي", value: { lion: 1 } } ] },
            { question: "أي بيئة عمل تناسبك أكثر؟", options: [ { text: "مكتب هادئ حيث يمكنني التركيز بمفردي", value: { owl: 1 } }, { text: "بيئة جماعية مليئة بالنقاش والعصف الذهني", value: { dolphin: 1, wolf: 1 } }, { text: "دور قيادي حيث أوجه الفريق نحو النجاح", value: { lion: 1 } }, { text: "بيئة مرنة ومتغيرة لا يوجد فيها روتين", value: { fox: 1 } } ] },
            { question: "ما هي أكبر نقاط قوتك؟", options: [ { text: "الولاء والعمل الجماعي", value: { wolf: 1 } }, { text: "الحكمة والملاحظة الدقيقة", value: { owl: 1 } }, { text: "الشجاعة والثقة بالنفس", value: { lion: 1 } }, { text: "الذكاء وسرعة البديهة", value: { fox: 1, dolphin: 1 } } ] },
            { question: "كيف تتخذ قراراتك الهامة؟", options: [ { text: "بناءً على المنطق والحقائق فقط", value: { owl: 1 } }, { text: "أتبع حدسي وما أشعر به", value: { fox: 1, dolphin: 1 } }, { text: "أتشاور مع من أثق بهم", value: { wolf: 1 } }, { text: "بسرعة وحسم، أثق بقراري", value: { lion: 1 } } ] },
            { question: "ما هو شعارك في الحياة؟", options: [ { text: "القوة في الاتحاد", value: { wolf: 1 } }, { text: "المعرفة هي القوة", value: { owl: 1 } }, { text: "كن قائدًا وليس تابعًا", value: { lion: 1 } }, { text: "الحياة مغامرة جريئة أو لا شيء", value: { dolphin: 1, fox: 1 } } ] },
            { question: "ماذا تفعل عندما تشعر بالملل؟", options: [ { text: "أتعلم شيئًا جديدًا أو أحل لغزًا", value: { owl: 1, fox: 1 } }, { text: "أتصل بأصدقائي للخروج واللعب", value: { dolphin: 1 } }, { text: "أخطط لهدفي الكبير القادم", value: { lion: 1 } }, { text: "أذهب للمشي في الطبيعة والتفكير", value: { wolf: 1 } } ] },
            { question: "صديقك في ورطة، ماذا تفعل؟", options: [ { text: "أقف بجانبه وأحميه بكل ما أملك", value: { lion: 1, wolf: 1 } }, { text: "أقدم له نصيحة حكيمة ومدروسة", value: { owl: 1 } }, { text: "أحاول التخفيف عنه بالفكاهة والمرح", value: { dolphin: 1 } }, { text: "أجد له مخرجًا ذكيًا من المشكلة", value: { fox: 1 } } ] },
            { question: "ما هو نوع العطلة المثالية لك؟", options: [ { text: "مخيم مع الأصدقاء المقربين في البرية", value: { wolf: 1 } }, { text: "منتجع فاخر يوفر كل سبل الراحة والقيادة", value: { lion: 1 } }, { text: "استكشاف مدينة جديدة مليئة بالغموض والتاريخ", value: { fox: 1, owl: 1 } }, { text: "شاطئ مشمس مليء بالألعاب المائية والنشاطات", value: { dolphin: 1 } } ] },
            { question: "ما الذي يلفت انتباهك في الآخرين؟", options: [ { text: "الذكاء والقدرة على التكيف", value: { fox: 1 } }, { text: "الروح المرحة والاجتماعية", value: { dolphin: 1 } }, { text: "الكاريزما وقوة الشخصية", value: { lion: 1 } }, { text: "الهدوء والعمق في التفكير", value: { owl: 1 } } ] }
        ];

        const animalData = {
            lion: { name: "الأسد", image: "https://i.imgur.com/Zu7WgfR.jpeg", description: "أنت قائد بالفطرة، تتمتع بشخصية قوية وكاريزما تجذب الآخرين إليك. أنت شجاع، واثق من نفسك، ومستعد دائمًا لحماية من تهتم بهم. تحب أن تكون في دائرة الضوء ولا تخشى تحمل المسؤولية." },
            owl: { name: "البومة", image: "https://i.imgur.com/ykxAuG6.jpeg", description: "أنت شخص حكيم، مفكر، ومراقب دقيق. تفضل الهدوء والتفكير العميق على الضوضاء. لديك نظرة ثاقبة وقدرة على رؤية ما لا يراه الآخرون. أصدقاؤك يلجأون إليك دائمًا لطلب النصيحة المدروسة." },
            wolf: { name: "الذئب", image: "https://i.imgur.com/JErCJWv.jpeg", description: "الولاء والعمل الجماعي هما أساس شخصيتك. أنت مخلص للغاية لأصدقائك وعائلتك وتعتبرهم 'قطيعك'. تعمل بشكل أفضل ضمن فريق، وتتمتع بحدس قوي وقدرة على التخطيط الاستراتيجي." },
            dolphin: { name: "الدولفين", image: "https://i.imgur.com/0Wk9KM2.jpeg", description: "أنت كائن اجتماعي، ذكي، ومرح للغاية. تحب التواصل مع الآخرين وتكوين الصداقات. لديك روح مرحة ومبدعة، وتجد دائمًا طرقًا جديدة وممتعة للاستمتاع بالحياة. طاقتك الإيجابية معدية." },
            fox: { name: "الثعلب", image: "https://i.imgur.com/h3rE8Wj.jpeg", description: "أنت ذكي، سريع البديهة، وقادر على التكيف مع أي موقف. تفكر بسرعة وتجد حلولًا ذكية للمشاكل. لديك جانب غامض ومستقل، وتعرف كيف تتنقل في المواقف الاجتماعية الصعبة بسهولة." }
        };

        // --- منطق الاختبار ---
        let currentQuestionIndex = 0;
        let scores = {};

        // --- [جديد] منطق المشاركة والتحميل ---
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const resultKey = urlParams.get('result');

            if (resultKey && animalData[resultKey]) {
                // إذا كان هناك نتيجة في الرابط، اعرضها مباشرة
                introScreen.classList.add('hidden');
                quizScreen.classList.add('hidden');
                resultScreen.classList.remove('hidden');
                displayResult(resultKey);

                // تعديل الأزرار لتناسب الزائر
                restartBtn.innerHTML = '<i class="fas fa-pen-alt"></i> ابدأ اختبارك الخاص';
                restartBtn.onclick = () => { window.location.href = window.location.pathname; };
                shareBtn.classList.add('hidden');
            }
        });


        function startQuiz() {
            currentQuestionIndex = 0;
            scores = { lion: 0, owl: 0, wolf: 0, dolphin: 0, fox: 0 };
            introScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            optionsContainer.innerHTML = '';
            const currentQ = questions[currentQuestionIndex];
            questionText.textContent = currentQ.question;
            questionNumber.textContent = `${currentQuestionIndex + 1}/${questions.length}`;
            
            currentQ.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option.text;
                button.className = 'option-btn';
                button.onclick = () => selectAnswer(option.value);
                optionsContainer.appendChild(button);
            });
            
            progressBar.style.width = `${((currentQuestionIndex + 1) / questions.length) * 100}%`;
        }
        
        function selectAnswer(value) {
            for (const animal in value) {
                if(scores[animal] !== undefined) scores[animal] += value[animal];
            }
            
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                finishQuiz();
            }
        }
        
        function finishQuiz() {
            let maxScore = -1;
            let resultAnimalKey = '';
            for (const animal in scores) {
                if (scores[animal] > maxScore) {
                    maxScore = scores[animal];
                    resultAnimalKey = animal;
                }
            }
            
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            displayResult(resultAnimalKey);
        }
        
        function displayResult(animalKey) {
            const finalAnimal = animalData[animalKey];
            resultImage.src = finalAnimal.image;
            resultAnimal.textContent = finalAnimal.name;
            resultDescription.textContent = finalAnimal.description;
            
            // استعادة شكل الأزرار الأصلي في حال كان المستخدم قد انتهى من الاختبار بنفسه
            restartBtn.innerHTML = '<i class="fas fa-redo"></i> إعادة الاختبار';
            restartBtn.onclick = startQuiz;
            shareBtn.classList.remove('hidden');
            setupShareButton(animalKey);
        }

        function setupShareButton(animalKey) {
            shareBtn.onclick = () => {
                const baseUrl = window.location.href.split('?')[0];
                const shareUrl = `${baseUrl}?result=${animalKey}`;
                const shareText = `شخصيتي تشبه الـ"${animalData[animalKey].name}"! اكتشف الحيوان الذي يشبهك أنت أيضًا عبر هذا الرابط:\n\n${shareUrl}`;

                if (navigator.share) {
                    navigator.share({
                        title: 'نتيجة اختبار شخصية الحيوان',
                        text: shareText,
                    }).catch(console.error);
                } else {
                    // fallback for desktop
                    const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText)}`;
                    window.open(whatsappUrl, '_blank');
                }
            };
        }

        startBtn.addEventListener('click', startQuiz);

    </script>

</body>
</html>
